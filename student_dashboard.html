<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate="status-title">–¢–≤—ñ–π –ó–∞–ª—ñ–∫–æ–≤–∏–π –°—Ç–∞—Ç—É—Å | SSRM</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Å—Ç–∏–ª—ñ –¥–ª—è –¥–∞—à–±–æ—Ä–¥—É */
        .dashboard-card {
            max-width: 700px;
            width: 100%;
            padding: var(--spacing-3xl);
            border-radius: var(--radius-2xl);
            background: var(--white);
            box-shadow: var(--shadow-xl);
            text-align: center;
        }

        .status-box {
            padding: var(--spacing-xl);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-lg);
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-extrabold);
            color: var(--white);
            text-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.8s ease-out;
        }
        
        /* –°–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –∫–æ–ª—å–æ—Ä–∏ —Å—Ç–∞—Ç—É—Å—ñ–≤ */
        .status-review { background: var(--primary-color); } /* –°–∏–Ω—ñ–π/–§—ñ–æ–ª–µ—Ç–æ–≤–∏–π */
        .status-passed { background: var(--success-color); } /* –ó–µ–ª–µ–Ω–∏–π */
        .status-failed { background: var(--danger-color); } /* –ß–µ—Ä–≤–æ–Ω–∏–π */
        .status-overdue { background: var(--warning-color); color: var(--gray-900); } /* –ñ–æ–≤—Ç–∏–π */

        .appeal-section {
            border-top: 1px solid var(--gray-200);
            padding-top: var(--spacing-lg);
            margin-top: var(--spacing-lg);
        }
    </style>
</head>
<body class="d-flex flex-column" style="min-height: 100vh; background: var(--gray-100);">

    <header class="header">
        <div class="header-container">
            <a href="index.html" class="logo">
                <div class="logo-icon">S</div>
                <span>SSRM</span>
            </a>
            <nav class="nav-controls gap-md">
                <a href="#" class="text-muted fw-semibold" onclick="SSRM.Auth.logout(); window.location.href='index.html';" data-translate="logout">–í–∏—Ö—ñ–¥</a>
                <div class="language-switcher">
                    <button class="lang-btn" data-lang="uk">üá∫üá¶ –£–ö–†</button>
                    <button class="lang-btn" data-lang="en">üá¨üáß ENG</button>
                </div>
            </nav>
        </div>
    </header>

    <main class="main-content d-flex align-center justify-center p-4" style="flex: 1;">
        <div class="dashboard-card animate-fadeInUp">
            <h2 class="mb-3 fw-bold text-primary" data-translate="status-title">SSRM: –¢–≤—ñ–π –ó–∞–ª—ñ–∫–æ–≤–∏–π –°—Ç–∞—Ç—É—Å</h2>
            <p class="text-muted fw-semibold mb-4" id="studentInfo">
                –°—Ç—É–¥–µ–Ω—Ç: –Ü–≤–∞–Ω–æ–≤ –Ü–≤–∞–Ω (–ü–ú-21)
            </p>

            <div id="statusDisplay">
                <div class="status-box status-review" id="currentStatusText">
                    <span data-translate="status-on-review">–û—á—ñ–∫—É—î –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –í–∏–∫–ª–∞–¥–∞—á–µ–º</span>
                </div>
                
                <p class="text-muted mt-3 mb-4" id="deadlineText">
                    <span data-translate="deadline-text">–ö—Ä–∞–π–Ω—ñ–π —Ç–µ—Ä–º—ñ–Ω –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:</span> 28.11.2025
                </p>
                
                <div class="appeal-section">
                    <p class="fw-semibold mb-3" data-translate="appeal-question">–•–æ—á–µ—Ç–µ –æ—Å–∫–∞—Ä–∂–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç?</p>
                    <button class="btn btn-warning btn-lg" id="appealButton" data-translate="appeal-button">
                        –û—Å–∫–∞—Ä–∂–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                    </button>
                    <p class="text-success mt-2 d-none" id="appealSuccess" data-translate="appeal-sent">
                        –ó–∞—è–≤–∫–∞ –Ω–∞ –æ—Å–ø–æ—Ä—é–≤–∞–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∞ –ó–∞–≤—ñ–¥—É–≤–∞—á—É –ö–∞—Ñ–µ–¥—Ä–∏!
                    </p>
                </div>
                
            </div>
            
            <div id="noTestSection" class="alert alert-info d-none">
                <p class="fw-bold" data-translate="no-test">–¢–µ—Å—Ç —â–µ –Ω–µ –∑–¥–∞–Ω–æ. –ë—É–¥—å –ª–∞—Å–∫–∞, –∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ.</p>
                <a href="quest.html" class="btn btn-primary mt-3">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –ó–∞–ª—ñ–∫—É</a>
            </div>

        </div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">hai-guys.space</div>
            <p class="footer-text" data-translate="footer-text">
                –°—Ç–µ–∂—Ç–µ –∑–∞ –Ω–∞—à–∏–º–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏!
            </p>
        </div>
    </footer>
    
    <script src="main.js"></script> 
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 1. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–æ–≤–∏
            SSRM.langManager.init(); 
            
            // 2. –Ü–º—ñ—Ç–∞—Ü—ñ—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å—É –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
            if (!SSRM.Auth.isAuthenticated()) {
                // –Ø–∫—â–æ –Ω–µ –∑–∞–ª–æ–≥—ñ–Ω–µ–Ω–∏–π, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î–º–æ –Ω–∞ –ª–æ–≥—ñ–Ω —Å—Ç—É–¥–µ–Ω—Ç–∞
                window.location.href = 'student_login.html';
                return;
            }

            // 3. –Ü–º—ñ—Ç–∞—Ü—ñ—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç–∞ (–¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó)
            // –£ —Ä–µ–∞–ª—å–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—ñ —Ü–µ –±—É–≤ –±–∏ AJAX-–∑–∞–ø–∏—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
            const mockData = {
                studentName: '–Ü–≤–∞–Ω–æ–≤ –Ü–≤–∞–Ω (–ü–ú-21)',
                // –ú–æ–∂–ª–∏–≤—ñ —Å—Ç–∞—Ç—É—Å–∏: 'REVIEW', 'PASSED', 'FAILED', 'NONE'
                status: 'FAILED', 
                reviewDeadline: new Date(new Date().getTime() - (3 * 24 * 60 * 60 * 1000)), // –ü—Ä–∏–∫–ª–∞–¥: –ü—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–æ 3 –¥–Ω—ñ
                // status: 'PASSED', reviewDeadline: new Date(Date.now() + (5 * 24 * 60 * 60 * 1000)),
                // status: 'REVIEW', reviewDeadline: new Date(Date.now() + (10 * 24 * 60 * 60 * 1000)),
                hasAppealed: false
            };
            
            // 4. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Å—Ç—É–¥–µ–Ω—Ç–∞
            document.getElementById('studentInfo').textContent = 
                `${SSRM.langManager.translate('student')}: ${mockData.studentName}`;


            const statusTextEl = document.getElementById('currentStatusText');
            const statusBoxEl = document.getElementById('statusDisplay');
            const deadlineTextEl = document.getElementById('deadlineText');
            const appealButtonEl = document.getElementById('appealButton');
            const noTestSectionEl = document.getElementById('noTestSection');

            // 5. –õ–æ–≥—ñ–∫–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É
            function updateStatusDisplay(status, deadline) {
                // –°–∫–∏–¥–∞—î–º–æ –∫–ª–∞—Å–∏
                statusTextEl.className = 'status-box';
                deadlineTextEl.classList.remove('d-none');
                appealButtonEl.classList.remove('d-none');
                statusBoxEl.classList.remove('d-none');
                noTestSectionEl.classList.add('d-none');
                
                let statusTranslationKey;
                let deadlineDisplay = SSRM.formatDate(deadline, SSRM.langManager.getCurrentLanguage());
                
                // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–Ω—è (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ SSRM.calculateUrgency)
                const urgency = SSRM.calculateUrgency(deadline);

                if (status === 'NONE') {
                    // –Ø–∫—â–æ —Ç–µ—Å—Ç —â–µ –Ω–µ –∑–¥–∞–Ω–æ
                    statusBoxEl.classList.add('d-none');
                    noTestSectionEl.classList.remove('d-none');
                    return;
                } else if (status === 'REVIEW') {
                    statusTextEl.classList.add('status-review');
                    statusTranslationKey = 'status-on-review';
                } else if (status === 'PASSED') {
                    statusTextEl.classList.add('status-passed');
                    statusTranslationKey = 'status-passed';
                    appealButtonEl.classList.add('d-none'); // –ù–µ–º–∞—î —Å–µ–Ω—Å—É –æ—Å–∫–∞—Ä–∂—É–≤–∞—Ç–∏ –∑–∞–ª—ñ–∫
                } else if (status === 'FAILED') {
                    if (urgency.daysLeft < -7) { 
                        // –Ø–∫—â–æ –Ω–µ–∑–∞–ª—ñ–∫ —ñ —Ç–µ—Ä–º—ñ–Ω –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–æ –±—ñ–ª—å—à–µ –Ω—ñ–∂ –Ω–∞ 7 –¥–Ω—ñ–≤, –ø–µ—Ä–µ—Ö–æ–¥–∏–º–æ –≤ —Ä–µ–∂–∏–º –∞—É–¥–∏—Ç—É/–ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–Ω—è
                        statusTextEl.classList.add('status-overdue');
                        statusTranslationKey = 'status-overdue';
                        deadlineDisplay = urgency.displayDays;
                    } else {
                        statusTextEl.classList.add('status-failed');
                        statusTranslationKey = 'status-failed';
                    }
                }

                // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—É—Å—É
                statusTextEl.querySelector('span').setAttribute('data-translate', statusTranslationKey);
                statusTextEl.querySelector('span').textContent = SSRM.langManager.translate(statusTranslationKey);
                
                // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ç–µ–∫—Å—Ç –¥–µ–¥–ª–∞–π–Ω—É (–∞–±–æ –π–æ–≥–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –¥–ª—è PASSED)
                if (status !== 'PASSED') {
                     deadlineTextEl.innerHTML = `${SSRM.langManager.translate('deadline-text')} <span class="fw-bold">${deadlineDisplay}</span>`;
                } else {
                    deadlineTextEl.classList.add('d-none');
                }

                // –û–±—Ä–æ–±–∫–∞ –æ—Å–∫–∞—Ä–∂–µ–Ω–Ω—è
                if (mockData.hasAppealed) {
                    appealButtonEl.classList.add('d-none');
                    document.getElementById('appealSuccess').classList.remove('d-none');
                }

            }

            // –ó–∞–ø—É—Å–∫ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
            updateStatusDisplay(mockData.status, mockData.reviewDeadline);


            // 6. –û–±—Ä–æ–±–Ω–∏–∫ –∫–Ω–æ–ø–∫–∏ –∞–ø–µ–ª—è—Ü—ñ—ó
            appealButtonEl.addEventListener('click', () => {
                if (mockData.status === 'FAILED') {
                    // –Ü–º—ñ—Ç–∞—Ü—ñ—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∞–ø–µ–ª—è—Ü—ñ—ó
                    mockData.hasAppealed = true;
                    SSRM.toast.warning(SSRM.langManager.translate('appeal-sent'), 5000);
                    appealButtonEl.classList.add('d-none');
                    document.getElementById('appealSuccess').classList.remove('d-none');
                } else {
                    SSRM.toast.error("–û—Å–∫–∞—Ä–∂–∏—Ç–∏ –º–æ–∂–Ω–∞ –ª–∏—à–µ '–ù–ï –ó–ê–õ–Ü–ö'!", 3000);
                }
            });

            // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–∫—É –∑–º—ñ–Ω–∏ –º–æ–≤–∏ –ø—ñ—Å–ª—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    // –ü–æ–≤—Ç–æ—Ä–Ω–æ –æ–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏ –º–æ–≤–∏, —â–æ–± –ø–µ—Ä–µ–∫–ª–∞—Å—Ç–∏ —Ç–µ—Ä–º—ñ–Ω–∏
                    setTimeout(() => {
                        updateStatusDisplay(mockData.status, mockData.reviewDeadline);
                    }, 50);
                });
            });

        });
    </script>
</body>
</html>
